:root {
  /* Light Theme (Default) */
  --bg-color: #ffffff;
  --text-color: #2e2e2e;
  --text-muted: #383838;
  --link-color: var(--text-color);
  --link-hover-color: #101010;
  --link-visited-color: #101010;
  --footer-bg: #f8f9faaa;
  /* Light footer */
  --footer-text: #343a40;
  --footer-heading: #212529;
  --footer-link: #384044;
  --footer-link-hover: #212529;
  --footer-copyright: #6c757d;
  --dynamic-bg-opacity: 0.3;

  /* Button Download Hover */
  --button-hover-bg: #55555516;
  --button-hover-text: #121212;
  --button-border-color: #55555599;
  --button-border-hover-color: #121212cc;

  --card-border-color: var(--button-border-color);
  --card-border-hover-color: var(--button-border-hover-color);

  --heading-color: var(--text-color);
  --text-heading-color: var(--text-color);
  --bg-muted: #f2f2f2;
  --tag-bg-color: rgba(0, 0, 0, 0.08);
  --tag-text-color: var(--text-muted);

  --theme-text: var(--text-color);
  --theme-heading-color: var(--text-color);
  --theme-text-lighter: var(--text-muted);
  --theme-icon-color: var(--text-muted);
  --theme-accent: var(--link-hover-color);

  --timeline-marker-border-color: #333;
  --timeline-marker-bg-color: #333;
  --timeline-line-color: #3333;

  --font-family-serif: "EB Garamond Variable", "EB Garamond", "Garamond", "Times New Roman", serif;
  --font-family-sans:
    "Inter Variable", "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica,
    Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
}

html.dark {
  /* Dark Theme Overrides */
  --bg-color: #121212;
  /* Slightly off-black */
  --text-color: #e3e3e3;
  --text-muted: #d4d4d4;
  --link-color: var(--text-color);
  --link-hover-color: #fff;
  --link-visited-color: #fff;
  --footer-bg: #161616aa;
  --footer-text: #cccccc;
  --footer-heading: #eeeeee;
  --footer-link: #cccccc;
  --footer-link-hover: #ffffff;
  --footer-copyright: #888888;
  --dynamic-bg-opacity: 0.4;

  /* Button Download Hover */
  --button-hover-bg: #cccccc26;
  --button-hover-text: #fff;
  --button-border-color: #cccccc99;
  --button-border-hover-color: #ffffffcc;

  --card-border-color: var(--button-border-color);
  --card-border-hover-color: var(--button-border-hover-color);

  --heading-color: var(--text-color);
  --text-heading-color: var(--text-color);
  --bg-muted: #1b1b1b;
  --tag-bg-color: rgba(255, 255, 255, 0.12);
  --tag-text-color: var(--text-muted);

  --theme-text: var(--text-color);
  --theme-heading-color: var(--text-color);
  --theme-text-lighter: var(--text-muted);
  --theme-icon-color: var(--text-muted);
  --theme-accent: var(--link-hover-color);

  --timeline-marker-border-color: #cccccc;
  --timeline-marker-bg-color: #cccccc;
  --timeline-line-color: #cccccc33;
}

html {
  /* Ensure no overscroll rule here */
  background-color: var(--bg-color);
  /* Use CSS variable */
}

html,
body {
  margin: 0;
  width: 100%;
  height: 100%;
  font-family: var(--font-family-serif);
  color: var(--text-color);
  /* Apply base text color */
  /* Ensure smooth transitions for color changes */
  transition:
    background-color 0.3s ease,
    color 0.3s ease;
}

p,
h1,
h2,
h3,
h4,
h5,
h6 {
  overflow-wrap: break-word;
}

/* Base Markdown Element Styles */
h1,
h2,
h3,
h4,
h5,
h6 {
  margin-top: 1.5em;
  margin-bottom: 0.5em;
  font-weight: 600;
  line-height: 1.3;
}

h1 {
  font-size: 2em;
}

h2 {
  font-size: 1.5em;
}

h3 {
  font-size: 1.25em;
}

p {
  margin-bottom: 1em;
}

p:last-child {
  margin-bottom: 0;
}

strong {
  font-weight: 600;
}

em {
  font-style: italic;
}

ul,
ol {
  margin: 0.6em 0;
  padding-left: 1em;
}

li {
  margin-bottom: 0.5em;
}

code {
  background-color: var(--code-bg, rgba(0, 0, 0, 0.05));
  padding: 0.2em 0.4em;
  border-radius: 3px;
  font-family: var(--font-family-mono, monospace);
  font-size: 0.9em;
}

pre {
  background-color: var(--code-bg, rgba(0, 0, 0, 0.05));
  padding: 1em;
  border-radius: 5px;
  overflow-x: auto;
  margin: 1em 0;
}

pre code {
  background-color: transparent;
  padding: 0;
}

blockquote {
  border-left: 3px solid var(--text-muted);
  padding-left: 1em;
  margin: 1em 0;
  font-style: italic;
  color: var(--text-muted);
}

hr {
  border: none;
  border-top: 1px solid var(--text-muted);
  margin: 2em 0;
}

.page-wrapper {
  height: 100vh;
  overflow-y: auto;
  position: relative;
  /* Context for absolutely positioned children if needed */
  overscroll-behavior-y: contain;
}

.main-content {
  min-height: 100vh;
  padding: 0;
}

@media (min-width: 768px) {
  .main-content {
    padding: 0 10vw;
  }
}

/* --- Animation Styles --- */

/* == Scroll Reveal Animation (Triggered by JS Intersection Observer) == */
.scroll-reveal-animate {
  /* Initial state */
  opacity: 0;
  filter: blur(5px);
  transform: translateY(20px) translateZ(0);
  will-change: auto;
  /* Transition applied when .visible is added */
  transition:
    opacity 0.8s ease-out,
    filter 0.8s ease-out,
    transform 0.8s ease-out;
}

.scroll-reveal-animate.visible {
  /* Final state */
  opacity: 1;
  filter: blur(0px);
  transform: translateY(0) translateZ(0);
}

/* == Page Load Animation (Triggered by CSS Animation on element load/re-insertion) == */
.page-load-initial-state {
  /* Initial state ONLY (no transition here) */
  opacity: 0;
  filter: blur(5px);
  transform: translateY(20px) translateZ(0);
  will-change: auto;
}

@keyframes pageLoadAnimate {
  to {
    /* Final state */
    opacity: 1;
    filter: blur(0px);
    transform: translateY(0) translateZ(0);
  }
}

/* Reduced motion support: disable animations for specific animation classes */
@media (prefers-reduced-motion: reduce) {
  /* Target animation classes specifically instead of all elements */
  .scroll-reveal-animate,
  .page-load-initial-state,
  [class*="animate-"] {
    animation: none !important;
    transition: none !important;
    opacity: 1 !important;
    filter: none !important;
    transform: none !important;
  }

  html {
    scroll-behavior: auto !important;
  }
}

html.reduce-motion .scroll-reveal-animate {
  opacity: 1 !important;
  filter: none !important;
  transform: none !important;
  transition: none !important;
}

html.reduce-motion .page-load-initial-state {
  animation: none !important;
  opacity: 1 !important;
  filter: none !important;
  transform: none !important;
}

/* Base link style */
a {
  color: var(--text-color);
  text-decoration: underline;
  /* Add default underline */
  text-underline-offset: 0.2em;
  /* Add default offset */
  transition: color 0.2s ease;
}

/* Hover and focus style */
a:hover,
a:focus,
a:active {
  color: var(--link-hover-color);
  text-decoration: underline;
  /* Ensure underline persists */
  text-underline-offset: 0.2em;
  /* Ensure offset persists */
}
