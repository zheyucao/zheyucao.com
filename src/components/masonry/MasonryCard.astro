---
import { Icon } from "astro-icon/components";
import { Image } from "astro:assets";
import type { ImageMetadata } from "astro";

interface Props {
  id?: string;
  title: string;
  imageSrc?: ImageMetadata;
  imageAlt?: string;
  date?: string;
  projectUrl?: string;
  githubUrl?: string;
  githubRepos?: { title?: string; url: string }[];
  techStack?: string[];
}

const {
  id,
  title,
  imageSrc,
  imageAlt = "Project thumbnail",
  date,
  projectUrl,
  githubUrl,
  githubRepos,
  techStack = [],
} = Astro.props;
---

<article id={id} class="project-card scroll-reveal-animate flex flex-col mb-12">
  {
    imageSrc && (
      <div class="project-image-wrapper">
        <Image src={imageSrc} alt={imageAlt} class="w-full h-full object-cover object-top block" />
      </div>
    )
  }
  <div class="project-content flex flex-col p-8">
    <header class="mb-4">
      <h3 class="project-title">{title}</h3>
    </header>

    <div class="project-metadata flex flex-col gap-[0.8rem] mb-4 font-sans">
      {date && <span class="project-date">{date}</span>}
      {
        techStack.length > 0 && (
          <div class="flex flex-wrap gap-[0.4rem] leading-[1.4] pt-[0.2em]">
            {techStack.map((tech) => (
              <span class="tech-tag">{tech}</span>
            ))}
          </div>
        )
      }
      <div class="project-links flex flex-wrap gap-[1.2rem] items-center">
        {
          githubRepos && githubRepos.length > 0 ? (
            githubRepos.map((repo) => (
              <a
                href={repo.url}
                target="_blank"
                rel="noopener noreferrer"
                title={`View ${repo.title || "source"} on GitHub`}
                class="inline-flex items-center gap-[0.4em]"
              >
                <Icon name="ri:github-line" /> {repo.title || "GitHub"}
              </a>
            ))
          ) : githubUrl ? (
            <a
              href={githubUrl}
              target="_blank"
              rel="noopener noreferrer"
              title="View source on GitHub"
              class="inline-flex items-center gap-[0.4em]"
            >
              <Icon name="ri:github-line" /> GitHub
            </a>
          ) : null
        }
        {
          projectUrl && (
            <a
              href={projectUrl}
              target="_blank"
              rel="noopener noreferrer"
              title="Visit live site"
              class="inline-flex items-center gap-[0.4em]"
            >
              <Icon name="ri:external-link-line" /> Live Site
            </a>
          )
        }
      </div>
    </div>

    <div class="project-body">
      <slot />
    </div>
  </div>
</article>

<style>
  /* Visual styling - borders, colors, transitions */
  .project-card {
    border-radius: 8px;
    border: 1px solid var(--card-border-color);
    overflow: hidden;
    opacity: 0;
    filter: blur(5px);
    transform: translateY(20px) translateZ(0);
    will-change: auto;
    transition:
      opacity 0.8s ease-out,
      filter 0.8s ease-out,
      transform 0.8s ease-out,
      border-color 0.2s ease;
  }

  .project-card.visible {
    opacity: 1;
    filter: blur(0px);
    transform: translateY(0) translateZ(0);
  }

  .project-card:hover {
    border-color: var(--card-border-hover-color);
  }

  .project-image-wrapper {
    aspect-ratio: 16 / 9;
    overflow: hidden;
    background-color: var(--bg-muted);
  }

  .project-title {
    font-size: 1.5rem;
    font-weight: normal;
    margin: 0;
    color: var(--heading-color);
    line-height: 1.3;
  }

  .project-date {
    font-size: 0.9rem;
    color: var(--text-muted);
    display: block;
  }

  .tech-tag {
    background-color: var(--tag-bg-color);
    color: var(--tag-text-color);
    font-size: 0.85rem;
    border-radius: 4px;
  }

  .project-links a {
    color: var(--link-color);
    text-decoration: none;
    font-size: 0.9rem;
    transition: color 0.2s ease;
  }
  .project-links a:hover {
    color: var(--link-hover-color);
    text-decoration: underline;
  }
  .project-links :global(svg) {
    font-size: 1.2em;
  }

  .project-body {
    font-size: 1.2rem;
    line-height: 1.8;
  }
  .project-body :global(p) {
    margin-bottom: 1em;
  }
  .project-body :global(ul) {
    padding-left: 1.5em;
    margin-top: 0.5em;
    list-style: disc;
  }
</style>
