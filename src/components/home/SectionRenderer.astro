---
import type { AstroComponentFactory } from "astro/runtime/server/index.js";
import type { HomepageSection } from "../../lib/homepageSections/registry";
import { resolveHomepageSectionRenderer } from "../../lib/homepageSections/registry";

interface Props {
  section: HomepageSection;
}

const { section } = Astro.props;

const rendererKey = resolveHomepageSectionRenderer(section);
const rendererPath = `./sectionRenderers/${rendererKey}.astro`;
const rendererModules = import.meta.glob("./sectionRenderers/*.astro", { eager: true });
const rendererModule = rendererModules[rendererPath];

if (!rendererModule) {
  throw new Error(`Missing renderer component for key: ${rendererKey}`);
}

const Renderer = (rendererModule as { default: AstroComponentFactory }).default;
---

<Renderer section={section} />
