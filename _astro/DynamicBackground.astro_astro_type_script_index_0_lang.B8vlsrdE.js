import{A as S}from"./animationConstants.C5dRCtVd.js";const y="http://www.w3.org/2000/svg",v={reds:["#FF6B6B","#FFD93D","#F2bF47","#F2B707","#F28706","#F26430"],oranges:["#FFa700","#FF9B58","#F27149","#F9c443","#faD93D"],yellows:["#FFD700","#FFDB58","#F2E109","#F9D423","#caD93D"],greens:["#90EE90","#6BCB77","#3CB371","#32CD32","#a0e9c4"],cyans:["#40E0D0","#AFEEEE","#7FFFD4","#B3E0F2","#9EfDF2"],blues:["#87CEEB","#64f5ED","#7De6FF","#42d5FF","#7299f9"],forest:["#64f5ED","#F2E109","#32CD32","#32CD32","#a0e9c4"],purples:["#996BcB","#c2aFF7","#8267d7","#FF55ff","#e264d0"],browns:["#8B4513","#A0522D","#D2691E","#DAA520","#8B3030"],winter:["#87CEEB","#64f5ED","#7De6FF","#cccccc","#ffffff"]};class B{container;svgContainer;svgGroup=null;blobs=[];rafId=null;mouseThrottleTimeout=null;mousePos=null;targetOffset={x:0,y:0};currentOffset={x:0,y:0};cachedContainerRect={width:0,height:0,left:0,top:0};needsRectUpdate=!0;isMobileDevice;config;fpsHistory=[];lastTimestamp=0;lastLogicExecutionTime=0;observer=null;isVisible=!0;prefersReducedMotion=!1;cleanupListeners=()=>{};forceStaticMode=!1;constructor(t,i){const e=document.getElementById(t),s=document.getElementById(i);if(!e||!s)throw new Error("DynamicBackground elements not found");this.container=e,this.svgContainer=s,this.isMobileDevice="maxTouchPoints"in navigator&&navigator.maxTouchPoints>0||window.innerWidth<1024,this.config={numBlobs:this.isMobileDevice?3:4,baseLargeMinBlobSize:1e3,baseLargeMaxBlobSize:1600,baseSmallMinBlobSize:600,baseSmallMaxBlobSize:1e3,referenceWidth:1440,minScaleFactor:.5,maxScaleFactor:1.5,speedMultiplier:this.isMobileDevice?.5:1,mouseInfluenceRadius:580,mouseForce:-800,opacity:.8,enableShapeChanging:!1,enableCollisionDetection:!0,enableMouseInteraction:!0},this.forceStaticMode=!this.detectChromium(),this.prefersReducedMotion=window.matchMedia("(prefers-reduced-motion: reduce)").matches,this.init()}init(){this.prefersReducedMotion||this.forceStaticMode?this.initStatic():(this.svgContainer.classList.add("css-hue-shift-active"),this.initBlobs(),this.setupEventListeners(),this.setupIntersectionObserver(),this.startAnimation()),requestAnimationFrame(()=>{this.container.classList.add("is-ready")})}initStatic(){this.config.numBlobs=3,this.initBlobs()}cleanup(){this.container.classList.remove("is-ready"),this.svgContainer.classList.remove("css-hue-shift-active"),this.stopAnimation(),this.mouseThrottleTimeout&&cancelAnimationFrame(this.mouseThrottleTimeout),this.cleanupListeners(),this.observer&&this.observer.disconnect(),this.blobs=[]}setupIntersectionObserver(){this.observer=new IntersectionObserver(t=>{t.forEach(i=>{this.isVisible=i.isIntersecting,this.isVisible?this.rafId||this.startAnimation():this.stopAnimation()})},{threshold:0}),this.observer.observe(this.container)}startAnimation(){!this.rafId&&this.isVisible&&!this.prefersReducedMotion&&!this.forceStaticMode&&(this.lastTimestamp=performance.now(),this.lastLogicExecutionTime=performance.now(),this.rafId=requestAnimationFrame(this.animate.bind(this)))}stopAnimation(){this.rafId&&(cancelAnimationFrame(this.rafId),this.rafId=null)}updateCachedRect(){if(this.needsRectUpdate){const t=this.svgContainer.getBoundingClientRect();this.cachedContainerRect={width:t.width,height:t.height,left:t.left,top:t.top},this.needsRectUpdate=!1}}animate(t){this.rafId=requestAnimationFrame(this.animate.bind(this));const{FPS:i}=S,e=1e3/i.TARGET,s=t-this.lastLogicExecutionTime;if(s<e)return;this.lastLogicExecutionTime=t-s%e;const r=t-this.lastTimestamp;if(this.lastTimestamp=t,!this.isMobileDevice&&r>0){const o=1e3/r;this.fpsHistory.push(o),this.fpsHistory.length>i.HISTORY_LENGTH&&this.fpsHistory.shift()}try{this.updateCachedRect();const o=this.cachedContainerRect.width,n=this.cachedContainerRect.height;this.svgGroup&&(this.currentOffset.x+=(this.targetOffset.x-this.currentOffset.x)*.05,this.currentOffset.y+=(this.targetOffset.y-this.currentOffset.y)*.05,this.svgGroup.setAttribute("transform",`translate(${this.currentOffset.x}, ${this.currentOffset.y})`)),this.blobs.forEach(a=>this.updateBlob(a,o,n))}catch(o){console.error("Error in animation loop:",o),this.stopAnimation()}}updateBlob(t,i,e){if(t.deformationTime+=1,t.position.x+=t.velocity.x,t.position.y+=t.velocity.y,t.angle+=t.angularVelocity,this.config.enableMouseInteraction&&this.mousePos){const n=t.position.x-this.mousePos.x,a=t.position.y-this.mousePos.y,h=n*n+a*a,c=this.config.mouseInfluenceRadius+t.radius*1.2;if(h<c*c){const f=Math.sqrt(h);if(c>.1){const u=Math.pow((c-f)/c,1.5),d=Math.atan2(a,n);t.velocity.x+=Math.cos(d)*u*this.config.mouseForce*this.config.speedMultiplier,t.velocity.y+=Math.sin(d)*u*this.config.mouseForce*this.config.speedMultiplier}}}const s=Math.sqrt(t.velocity.x**2+t.velocity.y**2),r=1.5*this.config.speedMultiplier;if(s>r&&(t.velocity.x*=r/s,t.velocity.y*=r/s),t.velocity.x*=.99,t.velocity.y*=.99,this.config.enableCollisionDetection)for(const a of this.blobs){if(t.id===a.id)continue;const h=a.position.x-t.position.x,c=a.position.y-t.position.y,f=h*h+c*c,u=(t.radius+a.radius)*.5,d=u*u;if(f<d&&f>0){const m=Math.sqrt(f),l=u-m,p=Math.atan2(c,h),F=Math.cos(p)*l*.01,x=Math.sin(p)*l*.01;t.velocity.x-=F,t.velocity.y-=x}}const o=.05*this.config.speedMultiplier;t.position.x<t.radius&&(t.velocity.x+=o),t.position.x>i-t.radius&&(t.velocity.x-=o),t.position.y<t.radius&&(t.velocity.y+=o),t.position.y>e-t.radius&&(t.velocity.y-=o),t.position.x=Math.max(t.radius/2,Math.min(i-t.radius/2,t.position.x)),t.position.y=Math.max(t.radius/2,Math.min(e-t.radius/2,t.position.y)),t.pathElement.setAttribute("transform",`translate(${t.position.x}, ${t.position.y}) rotate(${t.angle})`)}initBlobs(){this.blobs=[],this.svgContainer.innerHTML="",this.svgGroup=document.createElementNS(y,"g"),this.svgContainer.appendChild(this.svgGroup);const{width:t,height:i}=this.svgContainer.getBoundingClientRect(),e=window.innerWidth,s=Math.max(this.config.minScaleFactor,Math.min(this.config.maxScaleFactor,e/this.config.referenceWidth)),r=this.config.baseLargeMinBlobSize*s,o=this.config.baseLargeMaxBlobSize*s,n=this.config.baseSmallMinBlobSize*s,a=this.config.baseSmallMaxBlobSize*s,h=[],c=Object.keys(v),f=c[Math.floor(Math.random()*c.length)],u=v[f]||[],d=this.shuffleArray([...u]);for(let l=0;l<this.config.numBlobs;l++)h.push(d[l%d.length]||"#90EE90");const m=Math.ceil(this.config.numBlobs/2);for(let l=0;l<m;l++)this.createSingleBlob(l,r,o,h[l],t,i);for(let l=m;l<this.config.numBlobs;l++)this.createSingleBlob(l,n,a,h[l%h.length],t,i)}createSingleBlob(t,i,e,s,r,o){const n=this.random(i/2,e/2),a={x:this.random(n,r-n),y:this.random(n,o-n)},h=this.hexToHsl(s),c=this.createBlobPoints(0,0,n,.3,.2,8),f=this.createPathString(c.points),u={x:this.random(-1,1)*this.config.speedMultiplier,y:this.random(-1,1)*this.config.speedMultiplier},d=this.random(0,360),m=this.random(-.15,.15),l=document.createElementNS(y,"path");l.setAttribute("d",f),l.setAttribute("fill",s),l.setAttribute("transform",`translate(${a.x}, ${a.y}) rotate(${d})`),l.style.opacity=String(this.config.opacity),this.svgGroup.appendChild(l);const p={id:t,pathElement:l,position:a,velocity:u,radius:n,color:s,hsl:h||{h:0,s:0,l:50},points:c.points,angle:d,angularVelocity:m,baseAngles:c.angles,baseRadii:c.radii,deformationTime:0,deformationSpeed:this.random(.005,.015),deformationAmplitude:n*this.random(.05,.15)};this.blobs.push(p)}random(t,i){return Math.random()*(i-t)+t}shuffleArray(t){for(let i=t.length-1;i>0;i--){const e=Math.floor(Math.random()*(i+1));[t[i],t[e]]=[t[e],t[i]]}return t}hexToHsl(t){if(t=t.replace(/^#/,""),t.length===3&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),t.length!==6)return null;const i=parseInt(t.substring(0,2),16)/255,e=parseInt(t.substring(2,4),16)/255,s=parseInt(t.substring(4,6),16)/255,r=Math.max(i,e,s),o=Math.min(i,e,s);let n=0,a=0;const h=(r+o)/2;if(r!==o){const c=r-o;switch(a=h>.5?c/(2-r-o):c/(r+o),r){case i:n=(e-s)/c+(e<s?6:0);break;case e:n=(s-i)/c+2;break;case s:n=(i-e)/c+4;break}n/=6}return{h:Math.round(n*360),s:Math.round(a*100),l:Math.round(h*100)}}createBlobPoints(t,i,e,s,r,o){const n=[],a=[],h=[],c=Math.PI*2/o;for(let f=0;f<o;f++){const u=f*c;a.push(u);let d=e+this.random(-s,s)*e;d+=this.random(0,r)*e,d=Math.max(e*.2,d),h.push(d),n.push({x:t+Math.cos(u)*d,y:i+Math.sin(u)*d})}return{points:n,angles:a,radii:h}}createPathString(t){if(t.length<3)return"";let i=`M ${t[0].x} ${t[0].y}`;const e=t.length;for(let s=0;s<e;s++){const r=t[(s-1+e)%e],o=t[s],n=t[(s+1)%e],a=t[(s+2)%e],h=o.x+(n.x-r.x)/6,c=o.y+(n.y-r.y)/6,f=n.x-(a.x-o.x)/6,u=n.y-(a.y-o.y)/6;i+=` C ${h} ${c}, ${f} ${u}, ${n.x} ${n.y}`}return i+=" Z",i}setupEventListeners(){const t=()=>{this.needsRectUpdate=!0};window.addEventListener("resize",t);const i=s=>{this.config.enableMouseInteraction&&(this.mouseThrottleTimeout&&cancelAnimationFrame(this.mouseThrottleTimeout),this.mouseThrottleTimeout=requestAnimationFrame(()=>{try{this.updateCachedRect();const r=s.clientX,o=s.clientY;this.mousePos={x:r-this.cachedContainerRect.left,y:o-this.cachedContainerRect.top};const n=window.innerWidth/2,a=window.innerHeight/2,h=-.03;this.targetOffset.x=(r-n)*h,this.targetOffset.y=(o-a)*h}catch(r){console.error("Error in mousemove handler:",r)}}))};window.addEventListener("mousemove",i);const e=()=>{this.mousePos=null,this.targetOffset.x=0,this.targetOffset.y=0};window.addEventListener("mouseleave",e),this.cleanupListeners=()=>{window.removeEventListener("resize",t),window.removeEventListener("mousemove",i),window.removeEventListener("mouseleave",e)}}detectChromium(){const i=navigator.userAgentData?.brands;if(i?.length)return i.some(({brand:a})=>/Chromium|Chrome|Google Chrome|Microsoft Edge|Brave|Opera/i.test(a));const e=navigator.userAgent;if(/\b(iPad|iPhone|iPod)\b/.test(e))return!1;const r=/Chrome\/|CriOS\//.test(e),o=/Edg\//.test(e),n=/OPR\//.test(e);return r||o||n}}let g=null;function E(){if(!document.getElementById("dynamic-background-container")){C();return}if(!g)try{g=new B("dynamic-background-container","dynamic-background-svg")}catch(t){console.error("Failed to initialize DynamicBackground:",t)}}function C(){g&&(g.cleanup(),g=null)}document.addEventListener("astro:page-load",E);
